#!./docviewer
# View this document with docviewer, see 'docviewer --format' for input syntax
#
4. Customization - Basics, Passwords, Network
=============================================

    Content
    -------

        4.1 Introduction to centaurisoho
        4.2 Basic settings for centaurisoho
        4.3 Passwords for centaurisoho
        4.4 Network Configuration
        4.5 Certificates for SSL and OpenVPN, Certificate Authorities
        4.6 More

4.1 Introduction to centaurisoho
--------------------------------

bla

4.2 Basic settings for centaurisoho
-----------------------------------

bla

4.3 Passwords for centaurisoho
------------------------------

bla

4.4 Network Configuration
-------------------------

bla

4.5 Certificates for SSL and OpenVPN, Certificate Authorities
-------------------------------------------------------------

SSL and OpenVPN use different Certificate Authorities (CAs).
When creating a server image centaurisoho creates both CertificateAuthorities.
Per default these CAs contain wildcard server and client certificates only.

The following site-specific SSL certificates are used by centaurisoho and are
contained in the repository:

        Name            shared  Description
        ───────────────────────────────────────────────────────────────
        snakeoil        no      dummy used by debian default configs
        clientcrt       yes     per-client, used to identify the client
        servercrt.pem   yes     servers, used to identify the servers
        servercrt.key   no      servers, used to identify the servers
        revoked.pem     yes     (pem only) list of revoked certificates
        ───────────────────────────────────────────────────────────────

The debian snakeoil certificate is generated by centaurisoho using a debian tool
once for each cloned system image. See:

    make-ssl-cert generate-default-snakeoil

Next centaurisoho checks the repository on a server for servercrt or for clientcrt
otherwise. If it finds a certificate it symlinks this as server or client. When no
certificate was found it symlinks to snakeoil.



sind centauricert certs wildcard?
wird snakeoil regeneriert (wenn nicht in repo)
default is symlink to snakeoil für client/server

server  -> servercrt, snakeoil
client  -> clientcrt, snakeoil



SAN:

    DNS:<prim>.<dom>
    DNS:<scnd>.<dom>

    DNS:raspi*.<dom>
    DNS:peter*.<dom>
    DNS:alpha3.<dom>,DNS:alpha4.<dom>
    DNS:alpha5.<dom> ... DNS:alpha9.<dom>
    DNS:<host>.<dom>

was sind die ssh klassen?
    server
    appliance
    computer
    mobile

    option mobile alpha[5-9]

4.6 More
--------


Group hierarcy and Site-Group
-----------------------------

    users
    <site-group>
    staff
    wheel
    root

The <site-group> would ideally be the 1st part of the domain name. Unfortunately
the could be an existing linux group with special purpose. So we give group 1000
a special meaning as <site-group> gid. You can assign any name to this gid via
/etc/default/centauriusers. The default name is 'centauri'. The following checks
apply:
        1.  Group 'centauri' exists, done
        2.  GID 1000 exists, get group name
        3.  GID 1000 is a member group of user 'root'
        4.  Use group 'users' if check 2 or 3 failed


Passwords and other secrects
============================

Frequently linux tools read files containing poorly obfuscated secrets.
In centauri we do not keep these on disk, we load them from the currently
active server to ram. If no server can be reached, dummy secrets data
is generated.

The related tools are:

    -   centaurisecrets     locate a server, load secrets
    -   centauriusers       user and password management
    -   centaurkerberos     domain relationship and AD

centaurisecrets     locate a server, load secrets
=================================================

see:    /etc/default/centaurisecrets


centauriusers       user and password management
================================================

see:    /etc/default/centauriusers


centaurkerberos     domain relationship and AD
==============================================

see:    /etc/krb5.conf
        /etc/ker5.keytab


Security concerns
=================

Linux itself only stores hashed passwords in /etc/passwd.
centauriusers also saves passwords in /var/lib/extrausers.
All these .../passwd .../shadow and .../group file can safely
be synchronized using the centauri repository.

The sssd (system security services) daemon caches passwords.
How are they obfuscatad and how are they stored?

Do the samba *.tdb databases may contain any passwords?

***

